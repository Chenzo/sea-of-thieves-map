!function(e){var t={};function o(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,function(t){return e[t]}.bind(null,a));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){e.exports=o(2)},function(e,t){window.updateQueryStringParam=function(e,t){var o=[location.protocol,"//",location.host,location.pathname].join(""),s=document.location.search,a=e+"="+t,n="?"+a;if(s){var i=new RegExp("([?&])"+e+"[^&]*"),r=new RegExp("([?&])"+e+"=[^&;]+[&;]?");n=void 0===t||null==t||""==t?(n=s.replace(r,"$1")).replace(/[&;]$/,""):null!==s.match(i)?s.replace(i,"$1"+a):s+"&"+a}n="?"==n?"":n;var l=window.location.hash;window.history.replaceState({},"",o+n+l)},window.websafe=function(e){return e.match(/[a-zA-Z0-9]+/g).join("-").toLowerCase()},window.angle=function(e,t,o,s){var a=s-t,n=o-e;return Math.atan2(a,n)*(180/Math.PI)},window.angle360=function(e,t,o,s){var a=angle(e,t,o,s);return a<0&&(a=360+a),a},window.getCardinalFromDeg=function(e){var t="North";return e>=0&&11.25>e?t="North":e>=11.25&&33.75>e?t="North by North East":e>=33.75&&56.25>e?t="North East":e>=56.25&&78.75>e?t="East by North East":e>=78.75&&101.25>e?t="East":e>=101.25&&123.75>e?t="East by South East":e>=123.75&&146.25>e?t="South East":e>=146.25&&168.75>e?t="South by South East":e>=168.75&&191.25>e?t="South":e>=191.25&&213.75>e?t="South by South West":e>=213.75&&236.25>e?t="South West":e>=236.25&&258.75>e?t="West by South West":e>=258.75&&281.25>e?t="West":e>=281.25&&303.75>e?t="West by North West":e>=303.75&&326.25>e?t="North West":e>=326.25&&348.75>e&&(t="North by North West"),t},window.toggleFullScreen=function(){document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}},function(e,t,o){"use strict";o.r(t);var s;let a;window.addEventListener("load",function(){function e(e){console.log("online offline update"),navigator.onLine?console.log("went online"):console.log(" went offline")}window.addEventListener("online",e),window.addEventListener("offline",e)}),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("Service Worker Registered")}),s=!!navigator.onLine;var n,i=document.querySelector("#install-button");window.addEventListener("beforeinstallprompt",e=>{console.log("beforeinstallprompt - showme!!!"),e.preventDefault(),a=e,document.querySelector("#installBut").classList.add("showme")}),i.addEventListener("click",()=>{document.querySelector("#installBut").classList.remove("showme"),a.prompt(),a.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),a=null})}),window.addEventListener("appinstalled",e=>{console.log("a2hs","installed")});var r=0,l=0,c=function(e,t){caches.open("sotm-v1.8").then(o=>o.addAll(e.slice(l,l+t))).catch(function(e){console.log("ERROR!?!!!"),console.log(e)}).then(function(){console.log("DONE CACHING: ",l,t,r);var o=0;l==r?(console.log("REALLY REALLY done caching"),n="Install Complete: ",o=100):(l+t>r?(t=r-l,l=r):l+=t,o=l/r*100,c(e,t),n="Installing: "),console.log(o),$(".js-percent").html(n+Math.ceil(o)+"%")}).catch(function(e){console.log("Error Type 4"),console.log(e)})},u=(o(1),[]),p=window.location.pathname.substr(1);console.log("language: "+p);var d=[{loc:[-41.819753270587555,62.927539082707604],title:"Lone Cove",type:"île aux trésors",img:"loneCove.jpg",radius:3,pigs:!0,snakes:!0},{loc:[-69.94175507751075,50.54955884969927],title:"Cannon Cove",type:"île aux trésors",img:"cannonCove.jpg",radius:4,chickens:!0,pigs:!0},{loc:[-67.62877065330183,65.30062001780092],title:"Rum Runner Isle",type:"île aux trésors",radius:2,pigs:!0},{loc:[-80.94564356372827,121.30273506665486],title:"The Crooked Masts",type:"île aux trésors",radius:3,chickens:!0,snakes:!0},{loc:[-29.006074941430732,18.117840198163094],title:"Sailor's Bounty",type:"île aux trésors",img:"sailorsBounty.jpg",radius:4,chickens:!0,pigs:!0},{loc:[-21.065393452707312,42.86583042922642],title:"Smuggler's Bay",type:"île aux trésors",img:"smugglersBay.jpg",radius:4,chickens:!0,snakes:!0},{loc:[-22.940799321639105,57.487891142156535],title:"Salty Sands",type:"île aux trésors",img:"saltySands.jpg",radius:1.5,chickens:!0},{loc:[-28.629490743342114,69.55120761078706],title:"Picaroon Palms",type:"île aux trésors",img:"picaroonPalms.jpg",radius:1.5,snakes:!0},{loc:[-28.19171579987219,88.62081716840055],title:"Scurvy Isley",type:"île aux trésors",img:"scurveyIsley.jpg",radius:1.5},{loc:[-28.691820540241682,107.0555642878491],title:"Old Faithful Isle",type:"île aux trésors",img:"oldFaithfulIsle.jpg",radius:4,chickens:!0,pigs:!0},{loc:[-22.8781029334463,120.48941102991489],title:"Black Sand Atoll",type:"île aux trésors",radius:1.5,snakes:!0},{loc:[-21.566440856402263,136.5557290968507],title:"Marauder's Arch",type:"île aux trésors",radius:3,chickens:!0,pigs:!0},{loc:[-32.44278938865952,32.80535275921895],title:"Sandy Shallows",type:"île aux trésors",img:"sandyShallows.jpg",radius:1.5,snakes:!0},{loc:[-33.44299886939851,50.23934822463562],title:"Boulder Cay",type:"île aux trésors",img:"boulderCay.jpg",radius:1.5,chickens:!0},{loc:[-45.00792099044309,24.432035940703415],title:"Keel Haul Fort",type:"île aux trésors",img:"keelHaulFort.jpg",radius:2,isFortress:!0},{loc:[-48.25860180284481,43.931357643687285],title:"Sanctuary Outpost",type:"Avant-poste",img:"sanctuaryOutpost.jpg",radius:3,outpost:!0},{loc:[-56.135264556210544,57.616119333511065],title:"Lonely Isle",type:"île aux trésors",img:"lonelyIsle.jpg",radius:1.5,snakes:!0},{loc:[-55.3851074456563,71.67579309594387],title:"Hidden Spring Keep",type:"Fort squelette",img:"hiddenSpringKeep.jpg",radius:2,isFortress:!0},{loc:[-41.13192595693288,114.67807920810932],title:"Blind Man's Lagoon",type:"île aux trésors",radius:1.5,pigs:!0},{loc:[-34.818103609768,126.55069260749704],title:"Shark Fin Camp",type:"Fort squelette",img:"sharkFinCamp.jpg",radius:1.5,isFortress:!0},{loc:[-42.195761396643945,137.43053681968217],title:"Plunderer's Plight",type:"île aux trésors",img:"plunderOutpost.jpg",radius:2,pigs:!0},{loc:[-33.56895462527015,144.36651233641732],title:"Black Water Enclave",type:"île aux trésors",radius:1.5,chickens:!0},{loc:[-40.819360494201945,93.80847591354413],title:"Kraken's Watchtower",type:"fort squelette",radius:2,isFortress:!0},{loc:[-54.197162299085946,105.7433527036019],title:"Dagger Tooth Outpost",type:"Avant-poste",img:"daggerToothOutpost.jpg",radius:4,outpost:!0},{loc:[-52.32176952270034,125.36404020139321],title:"The Sunken Grove",type:"île aux trésors",radius:2,pigs:!0,snakes:!0},{loc:[-55.76110247916651,145.1163475274157],title:"Galleon's Grave Outpost",type:"Avant-poste",img:"galleonGraveOutpost.jpg",radius:3,outpost:!0},{loc:[-64.51072835956577,117.43038960965997],title:"Isle of Last Words",type:"île aux trésors",radius:1,pigs:!0,snakes:!0},{loc:[-67.69269774083621,130.11909434410913],title:"Skull Keep",type:"Fort squelette",radius:2,isFortress:!0},{loc:[-71.44348329360741,142.9912651229149],title:"Tri-Rock Isle",type:"île aux trésors",radius:2,chickens:!0},{loc:[-67.50237,151.430381],title:"Three Paces East Seapost",type:"poste en mer",radius:1,isSeapost:!0},{loc:[-59.281311,16.456299],title:"The Spoils of Plenty Store",type:"poste en mer",img:"theSpoilsOfPlentyStore.jpg",radius:1,isSeapost:!0},{loc:[-75.235017,64.342312],title:"The North Star Seapost",type:"poste en mer",radius:1,isSeapost:!0},{loc:[-114.96965,94.435731],title:"Stephen's Spoils",type:"poste en mer",img:"stephensSpoils.jpg",radius:1,isSeapost:!0},{loc:[-128.328685,48.139087],title:"The Finest Trading Post",type:"poste en mer",img:"theFinestTradingPost.jpg",radius:1,isSeapost:!0},{loc:[-29.844282,120.967678],title:"The Wild Treasures Store",type:"poste en mer",radius:1,isSeapost:!0},{loc:[-80.07029006498121,135.55539947884748],title:"Shiver Retreat",type:"île aux trésors",radius:2,pigs:!0},{loc:[-78.63248893641892,152.05177368081218],title:"Liar's Backbone",type:"île aux trésors",radius:2,snakes:!0},{loc:[-92.63542166676478,130.11909434410913],title:"Shark Tooth Key",type:"île aux trésors",radius:2,pigs:!0},{loc:[-92.19783001894149,144.99082563224394],title:"Kraken's Fall",type:"île aux trésors",img:"krakenFalls.jpg",radius:4,pigs:!0,snakes:!0},{loc:[-74.94438667929433,102.86928662127767],title:"Shipwreck Bay",type:"île aux trésors",radius:4,chickens:!0,pigs:!0},{loc:[-58.448248980419464,30.371595953863505],title:"Rapier Cay",type:"île aux trésors",img:"rapierCay.jpg",radius:1,chickens:!0},{loc:[-66.31539345270731,15.993498563600905],title:"Crescent Isle",type:"île aux trésors",img:"crescentIsle.jpg",radius:3,pigs:!0,snakes:!0},{loc:[-75.94243588991247,31.746234927654953],title:"Golden Sand Outpost",img:"goldenSandOutpost.jpg",type:"Avant-poste",radius:3,outpost:!0},{loc:[-81.88115349670785,16.993169376947787],title:"Sea Dog's Rest",type:"île aux trésors",radius:1.5,pigs:!0},{loc:[-81.6942164761939,60.23384927983136],title:"Twin Groves",type:"île aux trésors",radius:2,chickens:!0},{loc:[-91.6963112835838,48.48771722300551],title:"Wanderer's Refuge",type:"île aux trésors",img:"wanderersRefuge.jpg",radius:4,chickens:!0,snakes:!0},{loc:[-91.44625891339905,30.743560286098365],title:"Lagoon of Whispers",type:"île aux trésors",radius:2,chickens:!0,snakes:!0},{loc:[-97.13434807797746,16.305895692771806],title:"Mermaid's Hideaway",type:"île aux trésors",img:"mermaidsHideaway.jpg",radius:3,chickens:!0,pigs:!0},{loc:[-105.13603701643558,36.36971243938428],title:"Sailor's Knot Stronghold",type:"fort squelette",radius:2,isFortress:!0},{loc:[-103.69823588787327,72.10794401653528],title:"Fools Lagoon",type:"île aux trésors",radius:1.5,pigs:!0},{loc:[-100.84721297846644,83.52747464057205],title:"Castaway Isle",type:"île aux trésors",img:"castawayIsle.jpg",radius:1,snakes:!0},{loc:[-104.19511986188078,97.48786124216625],title:"Old Boot Fort",type:"fort squelette",radius:2,isFortress:!0},{loc:[-117.31967471531044,51.7447330135501],title:"Plunder Valley",type:"île aux trésors",img:"plunderValley.jpg",radius:4,chickens:!0,pigs:!0},{loc:[-115.8779065452535,69.80542248695795],title:"Chicken Isle",type:"île aux trésors",radius:2,chickens:!0,pigs:!0},{loc:[-115.25277561979163,85.05040239049788],title:"Snake Island",type:"île aux trésors",img:"snakeIsland.jpg",radius:3,pigs:!0,snakes:!0},{loc:[-116.75298510053062,106.67686315627111],title:"Crooks's Hollow",type:"île aux trésors",img:"crooksHollow.jpg",radius:3,chickens:!0,snakes:!0},{loc:[-114.69061602599248,122.1182928219427],title:"Barnacle Cay",type:"île aux trésors",radius:2,chickens:!0},{loc:[-126.31805123958326,134.36426028544201],title:"Ancient Spire Outpost",type:"Avant-poste",img:"ancientSpireOutpost.jpg",radius:2,outpost:!0},{loc:[-124.56687291042644,34.36631770202399],title:"Discovery Ridge",type:"île aux trésors",radius:4,chickens:!0,snakes:!0},{loc:[-137.44456997494095,45.05029951966879],title:"Old Salts Atoll",type:"île aux trésors",radius:2,chickens:!0},{loc:[-128.94278938865952,65.35611291577732],title:"Lost Gold Fort",type:"fort squelette",radius:2,isFortress:!0},{loc:[-144.821114895391,60.10784114570619],title:"Shark Bait Cove",type:"île aux trésors",radius:4,chickens:!0,pigs:!0},{loc:[-148.3847146692707,73.99154401784801],title:"Lookout Point",type:"île aux trésors",radius:2,pigs:!0},{loc:[-152.51057877731904,84.98792296466371],title:"Booty Isle",type:"île aux trésors",radius:1.5,snakes:!0},{loc:[-134.88188667929433,82.4887459312965],title:"Plunder Outpost",type:"Avant-poste",img:"plunderOutpost.jpg",radius:2,outpost:!0},{loc:[-126.75507990792053,95.36808708028451],title:"Paradise Spring",type:"île aux trésors",radius:2,pigs:!0},{loc:[-133.19392844017779,104.67752152957733],title:"Cutlass Cay",type:"île aux trésors",radius:1.5,snakes:!0},{loc:[-130.13078690541462,117.3608449739159],title:"The Crow's Nest Fortress",type:"fort squelette",img:"theCrowsNestFortress.jpg",radius:2,isFortress:!0},{loc:[-143.50858871029862,113.17472344302583],title:"Mutineer Rock",type:"île aux trésors",img:"mutineerRock.jpg",radius:2,chickens:!0},{loc:[-143.75864108048336,128.48218277239994],title:"Devil's Ridge",type:"île aux trésors",img:"devilsRidge.jpg",radius:3,pigs:!0,snakes:!0},{loc:[-147.8845051885317,98.80445550116441],title:"Thieves' Haven",type:"île aux trésors",radius:4,chickens:!0,pigs:!0},{loc:[-78.938966,191.556523],title:"Scorched Pass",type:"île aux trésors",radius:2,forsaken:!0},{loc:[-87.003155,200.022485],title:"Brian's Bazaar",type:"poste en mer",radius:1,forsaken:!0,isSeapost:!0},{loc:[-84.359375,209.328125],title:"Molten Sands Fortress",type:"île aux trésors",img:"keelHaulFort.jpg",radius:2.5,isFortress:!0},{loc:[-87.5329,177.748416],title:"Fetcher's Rest",type:"île aux trésors",radius:4,forsaken:!0,isSeapost:!1},{loc:[-96.568248,198.610248],title:"Cursewater Shores",type:"île aux trésors",radius:2,forsaken:!0,isSeapost:!1},{loc:[-104.69495,169.682274],title:"Cinder Islet",type:"île aux trésors",radius:2,forsaken:!0,isSeapost:!1},{loc:[-107.257986,185.614528],title:"Flintlock Peninsula",type:"île aux trésors",radius:4,forsaken:!0,isSeapost:!1},{loc:[-119.318876,201.609261],title:"Ruby's Fall",type:"île aux trésors",radius:3,forsaken:!0,isSeapost:!1},{loc:[-118.568719,165.308714],title:"The Forsaken Brink",type:"île aux trésors",radius:1.5,forsaken:!0,isSeapost:!1},{loc:[-127.003365,178.80427],title:"Marrow's Peak Outpost",type:"Avant-poste",radius:3,forsaken:!0,outpost:!0,isSeapost:!1},{loc:[-136.81792,198.36031],title:"Brimstone Rock",type:"île aux trésors",radius:1.5,forsaken:!0,isSeapost:!1},{loc:[-137.943156,212.605619],title:"Glowstone Cay",type:"île aux trésors",radius:1.5,forsaken:!0,isSeapost:!1},{loc:[-144.69457,179.491523],title:"Flame's End",type:"île aux trésors",radius:1.5,forsaken:!0,isSeapost:!1},{loc:[-147.193195,167.058118],title:"Roaring Traders",type:"poste en mer",radius:1,forsaken:!0,isSeapost:!0},{loc:[-152.506808,204.045938],title:"Magma's Tide",type:"île aux trésors",radius:2,forsaken:!0,isSeapost:!1},{loc:[-157.382829,187.676328],title:"The Devil's Thirst",type:"île aux trésors",radius:3,forsaken:!0,isSeapost:!1},{loc:[-159.258222,167.432994],title:"Burning Sands",type:"île aux trésors",radius:1.5,forsaken:!0,isSeapost:!1},{loc:[-172.636024,175.305402],title:"Ashen Reaches",type:"île aux trésors",radius:3,forsaken:!0,isSeapost:!1}],g=[{loc:[-16.1005,35.278949],title:"D3",isLarge:!0,desc:"Large (3rd out of the 4 offshore rocks counting from the east, at the back of the island, D2"},{loc:[-22.745271,135.124285],title:"Marauder's Arch",isLarge:!0,desc:"South top"},{loc:[-54.988041,71.873989],title:"Hidden Spring Keep",isLarge:!1,desc:" Very top, use the South West cannon"},{loc:[-142.478323,128.428828],title:"Devil's Ridge",isLarge:!1,desc:" North side underneath the ridge"},{loc:[-64.763573,86.934257],title:"K9",isLarge:!1,desc:"Underwater, uncharted island"},{loc:[-73.23633,103.936164],title:"Shipwreck Bay",isLarge:!0,desc:"Northern small island"},{loc:[-70.532986,51.038615],title:"Cannon Cove",isLarge:!0,desc:"Northern small island"},{loc:[-98.065754,17.249381],title:"Mermaid's Hideaway",isLarge:!1,desc:"Across from the Southern peak"},{loc:[-133.460937,80.585938],title:"Plunder Outpost",isLarge:!0,desc:"South top"},{loc:[-148.01744,101.459982],title:"Thieves Haven",isLarge:!1,desc:"East rock in the water"},{loc:[-135.604944,83.10854],title:"Plunder Outpost",isLarge:!0,desc:"South top"}],m=[{loc:[-19.29761,43.108748],title:"Smugglers Bay"},{loc:[-22.235517,136.749201],title:"Marauder's Arch"},{loc:[-70.501164,50.554064],title:"Cannon Cove"},{loc:[-80.548623,120.702367],title:"The Crooked Masts"},{loc:[-90.954813,145.288321],title:"Kraken's Fall"},{loc:[-85.642033,179.030255],title:"Fetcher's Rest"},{loc:[-96.767313,15.671325],title:"Mermaid's Hideaway"},{loc:[-118.127325,52.124172],title:"Plunder Valley"},{loc:[-117.744397,107.006777],title:"Crook's Hollow"},{loc:[-119.517574,201.600493],title:"Crook's Hollow"},{loc:[-143.071842,128.265031],title:"Devil's Ridge"},{loc:[-156.431205,187.968065],title:"The Devil's Thirst"}],h=[{loc:[-42.471588,61.804962],title:"Lone Cove - Deadshot Charlotte"},{loc:[-73.784149,103.488647],title:"Shipwreck Bay - Grogsoaked Ed"},{loc:[-92.504761,147.521606],title:"Kraken's Fall - Lootin Penelope"},{loc:[-88.219971,176.605042],title:"Fletcher's Rest - Walter the Feared"},{loc:[-119.66217,200.650238],title:"Ruby's Fall - Burnin' Tony"},{loc:[-143.671936,128.255554],title:"Devil's Ridge - Martha the Fierce"},{loc:[-116.560669,106.010834],title:"Crook's Hollow - Wild Henry"},{loc:[-96.860016,16.258972],title:"Mermaid's Hideaway - Five Paces Frank"}];d.forEach(function(e){e.searchData="island|"+e.title}),h.forEach(function(e){e.searchData="cargorun|"+e.title});var y,k=s,f=!1,v=[],w=-1;console.log("-- detect isOnline: "+k);var S="";"localhost"!=location.hostname&&(S="https://cdn.chenzorama.com/"),function(){var e=L.GridLayer.prototype._initTile;L.GridLayer.include({_initTile:function(t){e.call(this,t);var o=this.getTileSize();t.style.width=o.x+1+"px",t.style.height=o.y+1+"px"}})}();var x=L.map("mapid",{maxZoom:7,minZoom:2,crs:L.CRS.Simple,attributionControl:!1,preferCanvas:!1,maxBoundsViscosity:1}).setView([70,70],4),C=new L.LatLngBounds(x.unproject([0,25522],7),x.unproject([27444,0],7));x.setMaxBounds(C,{padding:[600,600]}),new L.Hash(x),L.tileLayer(S+"images/tiles/v2.5/{z}/{x}/{y}.png",{minZoom:2,maxZoom:7,bounds:C,noWrap:!0,tms:!1}).addTo(x);var b=L.icon({iconUrl:"/images/markers/xmarkthespot_marker.png",shadowUrl:"/images/markers/xmarkthespot_marker.png",iconSize:[40,52],shadowSize:[0,0],iconAnchor:[20,52],shadowAnchor:[0,0],popupAnchor:[0,0]}),j=(L.icon({iconUrl:"/images/markers/compass.png",shadowUrl:"/images/markers/compass.png",iconSize:[50,48],shadowSize:[0,0],iconAnchor:[25,24],shadowAnchor:[0,0],popupAnchor:[0,0]}),L.icon({iconUrl:"/images/markers/boat_marker.png",shadowUrl:"/images/markers/boat_marker.png",iconSize:[50,59],shadowSize:[0,0],iconAnchor:[25,29],shadowAnchor:[0,0],popupAnchor:[0,0]}));x.on("click",function(e){console.log("You clicked the map at "+e.latlng)});var F=new L.LayerGroup;x.addLayer(F);var T=new L.LayerGroup;u.push(["islands",A]),x.addLayer(T);var A=new L.LayerGroup;u.push(["chickens",A]);var E=new L.LayerGroup;u.push(["snakes",E]);var O=new L.LayerGroup;u.push(["pigs",O]);var R=L.icon({iconUrl:"/images/markers/chicken_marker.png",shadowUrl:"/images/markers/chicken_marker.png",iconSize:[30,30],shadowSize:[0,0],iconAnchor:[0,30],shadowAnchor:[0,0],popupAnchor:[0,0]}),M=L.icon({iconUrl:"/images/markers/snake_marker.png",shadowUrl:"/images/markers/snake_marker.png",iconSize:[30,30],shadowSize:[0,0],iconAnchor:[30,30],shadowAnchor:[0,0],popupAnchor:[0,0]}),P=L.icon({iconUrl:"/images/markers/pig_marker.png",shadowUrl:"/images/markers/pig_marker.png",iconSize:[30,30],shadowSize:[0,0],iconAnchor:[30,0],shadowAnchor:[0,0],popupAnchor:[0,0]});L.islandCircle=L.Circle.extend({options:{name:"islandName",json:{}}});var B=[];for(var z in d){var N=d[z].title,_=d[z].radius,I="islandClass "+window.websafe(N),H=new L.islandCircle(d[z].loc,{strokeweight:1,opacity:0,color:"#fff",fillColor:"#fff",fillOpacity:0,radius:_,className:I,name:N,title:N,json:d[z]}),D=de(d[z].loc,_+.1*_,0),U=new L.Marker(D,{icon:new L.DivIcon({className:"title-location",iconAnchor:[0,0],iconSize:null,html:'<span class="my-div-span" data-anchor-x="0">'+d[z].title+"</span>"})}).addTo(T);if(U.bindPopup('<div class="lf-popup"><img src="/images/screenshots/small/'+(void 0!==d[z].img?d[z].img:"bientot.jpg")+'" /><span class="popup-title-island">'+d[z].title+'</span><span class="popup-type-island">'+d[z].type+'</span><span class="popup-img-island hiddenDiv">'+(void 0!==d[z].img?d[z].img:"bientot.jpg")+'</span><span class="popup-hasChickens-island hiddenDiv">'+(d[z].hasOwnProperty("chickens")?"O":"N")+'</span><span class="popup-hasPigs-island hiddenDiv">'+(d[z].hasOwnProperty("pigs")?"O":"N")+'</span><span class="popup-hasSnakes-island hiddenDiv">'+(d[z].hasOwnProperty("snakes")?"O":"N")+"</span></div>",{minWidth:322}),U.on("mouseover",function(e){this.openPopup()}),U.on("mouseout",function(e){this.closePopup()}),U.on("click",function(e){x.setView(this.getLatLng(),6);var t=document.getElementById("islandModal"),o=document.getElementById("islandModalImg"),s=document.getElementById("islandModalTitre"),a=document.getElementById("islandModalType"),n=document.getElementsByClassName("closeModal")[0];t.style.display="block",n.onclick=function(){t.style.display="none"},window.onclick=function(e){e.target==t&&(t.style.display="none")},o.src="/images/screenshots/medium/"+document.getElementsByClassName("popup-img-island")[0].innerHTML,s.innerHTML=document.getElementsByClassName("popup-title-island")[0].innerHTML,a.innerHTML=document.getElementsByClassName("popup-type-island")[0].innerHTML,$("#islandModalAnimals").html(""),"O"==document.getElementsByClassName("popup-hasChickens-island")[0].innerHTML&&$("#islandModalAnimals").append('<div class="animal-box"><img src="/images/animal-info-box/chicken-icon-small.png" /></div>'),"O"==document.getElementsByClassName("popup-hasPigs-island")[0].innerHTML&&$("#islandModalAnimals").append('<div class="animal-box"><img src="/images/animal-info-box/pig-icon-white.png" height="20" /></div>'),"O"==document.getElementsByClassName("popup-hasSnakes-island")[0].innerHTML&&$("#islandModalAnimals").append('<div class="animal-box"><img src="/images/animal-info-box/snake-icon-white-small.png" /></div>'),this.closePopup()}),F.addLayer(H),B[z]=H,d[z].circle=H,H.on({mousedown:function(e){f?(e.target.classList.add("pig show"),x.dragging.disable(),x.on("mousemove",function(t){e.target.setLatLng(t.latlng)})):(e.target._path.classList.remove("pig","show"),re(),ue())},mouseup:function(e){f&&(x.removeEventListener("mousemove"),console.log(e.target.options.title),console.log("["+e.latlng.lat+", "+e.latlng.lng+"],"),x.dragging.enable())}}),d[z].chickens){var W=de(d[z].loc,.5*_,.6*_);(q=L.marker(W,{icon:R,title:"chicken"}).addTo(A)).setIcon(R)}if(d[z].snakes)var G=de(d[z].loc,.5*_,.6*_*-1),q=L.marker(G,{icon:M,title:"snake"}).addTo(E);if(d[z].pigs){var Z=de(d[z].loc,.5*_*-1,.6*_*-1);q=L.marker(Z,{icon:P,title:"pigs"}).addTo(O)}}x.on("zoomend",function(){x.getZoom()<4?x.removeLayer(T):x.addLayer(T);var e=$(".title-location");switch(x.getZoom()){case 5:e.css("font-size",24),x.getZoom(),x.getZoom();break;case 6:e.css("font-size",33),x.getZoom(),x.getZoom();break;case 7:e.css("font-size",63),x.getZoom(),x.getZoom();break;default:e.css("font-size",14),x.getZoom()}});var K=new L.LayerGroup;u.push(["beacons",K]);var V=L.icon({iconUrl:"/images/markers/beacon_marker.png",shadowUrl:"/images/markers/beacon_marker.png",iconSize:[31,40],shadowSize:[0,0],iconAnchor:[15,40],shadowAnchor:[0,0],popupAnchor:[-20,-45]});for(var Y in m){var Q=m[Y].loc;q=L.marker(Q,{icon:V,title:"Beacon"}).addTo(K)}var J=new L.LayerGroup;u.push(["cargoruns",J]);var X=L.icon({iconUrl:"/images/markers/crate_marker.png",shadowUrl:"/images/markers/crate_marker.png",iconSize:[31,40],shadowSize:[0,0],iconAnchor:[15,40],shadowAnchor:[0,0],popupAnchor:[0,-45]}),ee=[];for(var Y in h)Q=h[Y].loc,q=L.marker(Q,{icon:X,title:"Cargo Run",name:h[Y].title}).addTo(J).bindPopup(h[Y].title),ee[Y]=q;var te=new L.LayerGroup;u.push(["thrones",te]);var oe=L.icon({iconUrl:"/images/markers/throne_marker.png",shadowUrl:"/images/markers/throne_marker.png",iconSize:[30,30],shadowSize:[0,0],iconAnchor:[15,30],shadowAnchor:[0,0],popupAnchor:[-20,-45]});for(var Y in g)Q=g[Y].loc,q=L.marker(Q,{icon:oe,title:"Skelton Throne"}).addTo(te).bindPopup(g[Y].desc);var se,ae=L.layerGroup([F]),ne=new L.Control.Search({position:"topright",layer:ae,propertyName:"name",initial:!1,zoom:6,marker:!1,buildTip:function(e,t){return'<a href="#" class="'+function(e){var t="island";return ee.forEach(function(o){o.getLatLng().lat==e.lat&&o.getLatLng().lng==e.lng&&(console.log("Cargo Run Destination Found"),t="cargo")}),t}(t)+'">'+e+"</a>"}});x.addControl(ne),ne.on("search:locationfound",function(e){console.log(e),void 0!==(se=e.layer).setOpacity&&(se.setOpacity(1),se.openPopup())}),ne.on("search:collapsed",function(e){void 0!==se.setOpacity&&(se.setOpacity(0),se.closePopup())});var ie=L.popup({maxWidth:"500",minWidth:"120",className:"context_popup"});function re(){y&&x.removeLayer(y)}function le(e){var t=L.marker(e,{icon:b,draggable:!0}).addTo(x);t.on("dragend",function(e){console.log("marker dragend event"),ge()}),v.push(t)}function ce(e){$(".floating_dialog").html(e).addClass("show")}function ue(){$(".floating_dialog").removeClass("show")}function pe(){x.getZoom()>=4&&$(".leaflet-grid-label").addClass("big")}function de(e,t,o){return[e[0]+t,e[1]+o]}function ge(){var e=function(){var e,t="";return v.forEach(function(o){e=o.getLatLng().lat+","+o.getLatLng().lng+";",t+=e}),t=window.encodeURIComponent(window.btoa(t))}();updateQueryStringParam("mkrs",e)}x.on("contextmenu",function(e){var t=e.latlng;ie.setLatLng(e.latlng).setContent("<ul><li class='js-addMarker'>Add Marker</li>        <li class='js-clearMarkers'>Clear Markers</li>        <li class='js-closest' data-type='chickens'>Closest Chickens</li>        <li class='js-closest' data-type='pigs'>Closest Pigs</li>        <li class='js-closest' data-type='snakes'>Closest Snakes</li>        <li class='js-closest' data-type='outpost'>Closest Outpost</li>        </ul>").openOn(x),$(".js-addMarker").click(function(){le(t),ge(),x.closePopup()}),$(".js-clearMarkers").click(function(){v.forEach(function(e){x.removeLayer(e)}),v=[],re(),ue(),ge(),x.closePopup()}),$(".js-closest").click(function(){var o=$(this).data("type"),s=function(e,t){var o,s=1e3,a={};for(var n in d){var i=d[n].title,r=d[n].loc;(o=x.distance(r,e))<s&&d[n][t]&&(s=o,a.title=i,a.islandData=d[n])}return a.bearing=window.angle360(e.lat,e.lng,a.islandData.loc[0],a.islandData.loc[1]),a}(e.latlng,o),a=s.islandData;$(".islandClass").removeClass("show pigs chickens snakes outposts"),a.circle._path.classList.add(o,"show");var n="<span class='type'>"+(o.charAt(0).toUpperCase()+o.slice(1))+"</span> can be found to the <span class='direction'>"+window.getCardinalFromDeg(s.bearing)+"</span> at <span class='title'>"+s.title+"</span>";!function(e,t){re(),y=L.marker(e,{icon:j,draggable:!1}).addTo(x),console.log(y._icon.style);var o=y._icon.style.transform+" rotate("+t+"deg)";console.log(o),y._icon.style.transform=o,v.push(y)}(t,s.bearing),ce(n),x.closePopup()})}),L.simpleGraticule({interval:8.2,vinterval:7.7,showOriginLabel:!1,redraw:"move"}).addTo(x),x.on("zoomend",function(){pe()}),x.on("move",function(){pe()}),x.on("moveend",function(){pe()}),window.dev={toggleOn:function(){console.log("dev"),$(".islandClass").addClass("show"),f=!0}};var me=0;$(function(){$(".js-searchforisland").click(function(){var e=function e(t){return"left"==t?--w<0&&(w=d.length-1):++w>=d.length&&(w=0),d[w].isFortress||d[w].outpost||d[w].isSeapost?e(t):d[w]}($(this).data("dir")).loc;x.setView(e,7),pe(),ce("Island "+(w+1)+" of "+d.length),clearTimeout(me),me=setTimeout(ue,3e3)}),$(".js-toggleMarkers").click(function(){!function(e,t){var o=function(e){for(var t=0;t<u.length;t++)if(u[t][0]==e)return u[t][1]}(e);t?x.addLayer(o):x.removeLayer(o)}($(this).attr("name"),$(this).is(":checked"))}),$(".js-fullscreen").click(function(){window.toggleFullScreen()}),$(".js-share").click(function(){var e=window.location.href;navigator.clipboard.writeText(e).then(function(){console.log("Async: Copying to clipboard was successful!"),ce("Current Map Location URL Copied To Clipboard!"),setTimeout(ue,4e3)},function(e){console.error("Async: Could not copy text: ",e)})}),$(".js-installfiles").click(function(){console.log("click install"),function(){console.log("installer called");var e=new XMLHttpRequest;e.open("GET","data/mapfile_list.json?cb=5",!0),e.onload=function(){if(e.status>=200&&e.status<400){var t=JSON.parse(e.responseText).mapFileList;r=t.length,console.log(t.length),c(t,100)}else console.log("ERROR")},e.onerror=function(){console.log("ERROR")},e.send()}()}),$(".js-settings").click(function(){console.log("click settings"),$(".settings").addClass("open")}),$(".js-close-settings").click(function(){console.log("click settings"),$(".settings").removeClass("open")}),function(){var e=new URLSearchParams(window.location.search),t=window.decodeURIComponent(e.get("mkrs"));null!==e.get("mkrs")&&window.atob(t).split(";").forEach(function(e){""!==e&&le(e.split(","))})}()})}]);
//# sourceMappingURL=maps/sotm.js.map